
<!DOCTYPE html>
<html lang="english">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />     <meta name="robots" content="" />     <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">     <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/stylesheet/style.min.css"> 
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/pygments/github.min.css">
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/font-awesome/css/fontawesome.css">
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/font-awesome/css/brands.css">
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/font-awesome/css/solid.css">
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/font-awesome.css">     <script src="https://jackmckew.dev/theme/tipuesearch/jquery.min.js"></script>
    <script src="https://jackmckew.dev/theme/tipuesearch/tipuesearch.min.js"></script>
    <script src="https://jackmckew.dev/theme/tipuesearch/tipuesearch.js"></script>
    <script src="https://jackmckew.dev/theme/tipuesearch/tipuesearch_set.js"></script>
    <link rel="stylesheet" href="https://jackmckew.dev/theme/tipuesearch/tipuesearch.css" />
    <script src="https://jackmckew.dev/tipuesearch_content.js"></script>
    <link href="https://jackmckew.dev/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack McKew's Blog Atom">     <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon"> <!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-131173168-2', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics --><meta name="author" content="Jack McKew" />
<meta name="description" content="Kubernetes is a portable, extensible, open-source platform for managing containerized workloads and services, that facilitates both declarative configuration and automation. We use Kubernetes as a platform for orchestrating multiple Docker containers for our application, and enables us to scale our application easily. Kubernetes is managed via a master node, and â€¦" />
<meta name="keywords" content="software">


<meta property="og:site_name" content="Jack McKew's Blog"/>
<meta property="og:title" content="Intro to Kubernetes"/>
<meta property="og:description" content="Kubernetes is a portable, extensible, open-source platform for managing containerized workloads and services, that facilitates both declarative configuration and automation. We use Kubernetes as a platform for orchestrating multiple Docker containers for our application, and enables us to scale our application easily. Kubernetes is managed via a master node, and â€¦"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://jackmckew.dev/intro-to-kubernetes.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2020-11-13 00:00:00+11:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://jackmckew.dev/author/jack-mckew.html">
<meta property="article:section" content="Software"/>
<meta property="article:tag" content="software"/>
<meta property="og:image" content="https://jackmckew.dev/img/Kubernetes-logo.png">

    <title>Jack McKew's Blog &ndash; Intro to Kubernetes</title>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1052275056735196"
     crossorigin="anonymous"></script>
</head>

<body>
    <aside>
        <div>
            <a href="https://jackmckew.dev">
        <img src="/jm-photo.jpg" alt="Jack McKew's Blog" title="Jack McKew's Blog">
      </a>
            <h1><a href="https://jackmckew.dev">Jack McKew's Blog</a></h1>

            <p>Engineer | Software Developer | Data Scientist</p>            <p>Number of Posts: 101</p>
            <p>Number of Words: 74,752</p>
            <p>Number of Lines of Code 4,674</p>
            <form class="navbar-search" action="/search.html" role="search">
                <input type="text" name="q" id="tipue_search_input" placeholder="Search..">
            </form>
            <style>
                .bmc-button img {
                    height: 34px !important;
                    width: 35px !important;
                    margin-bottom: 1px !important;
                    box-shadow: none !important;
                    border: none !important;
                    vertical-align: middle !important;
                }
                
                .bmc-button {
                    margin-top: 15px !important;
                    margin-bottom: 20px !important;
                    padding: 7px 15px 7px 10px !important;
                    line-height: 35px !important;
                    height: 51px !important;
                    text-decoration: none !important;
                    display: inline-flex !important;
                    color: #ffffff !important;
                    /* background-color: #FF813F !important; */
                    border-radius: 5px !important;
                    border: 1px solid transparent !important;
                    padding: 7px 15px 7px 10px !important;
                    font-size: 22px !important;
                    letter-spacing: 0.6px !important;
                    box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;
                    -webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
                    font-family: 'Cookie', cursive !important;
                    -webkit-box-sizing: border-box !important;
                    box-sizing: border-box !important;
                }
                
                .bmc-button:hover,
                .bmc-button:active,
                .bmc-button:focus {
                    -webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
                    text-decoration: none !important;
                    box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
                    opacity: 0.85 !important;
                    color: #ffffff !important;
                }
            </style>
            <link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet">
            <a class="bmc-button btn" target="_blank" href="https://www.buymeacoffee.com/jackmckew"><img src="https://jackmckew.dev/theme/img/pizza.png" alt="ðŸ•"><span style="margin-left:5px;font-size:28px !important;">Buy me a Pizza</span></a>
            <nav>
                <ul class="list">
                    <li><a target="_blank" href="https://jackmckew.dev/pages/contact.html#contact">Contact</a></li>
                    <li><a target="_blank" href="https://jackmckew.dev/pages/cv-professional.html#cv-professional">CV/Professional</a></li>
                </ul>
            </nav>

            <ul class="social">
                <li>
                    <a  class="sc-twitter" href="https://twitter.com/Jac_McQ" target="_blank">
                        <i class="fab fa-twitter">
            </i>
                    </a>
                </li>
                <li>
                    <a  class="sc-linkedin" href="https://www.linkedin.com/in/jack-mckew/" target="_blank">
                        <i class="fab fa-linkedin">
            </i>
                    </a>
                </li>
                <li>
                    <a  class="sc-github" href="https://github.com/JackMcKew" target="_blank">
                        <i class="fab fa-github">
            </i>
                    </a>
                </li>
            </ul>
        </div>


    </aside>
    <main>
        <nav>
            <a href="https://jackmckew.dev"> Home</a>             <a href="/archives.html">Archives</a>             <a href="/categories.html">Categories</a>             <a href="/tags.html">Tags</a>             <a href="/sitemap.xml">Sitemap</a>             <a href="https://jackmckew.dev/feeds/all.atom.xml"> Atom</a>         </nav>
<article class="single">
  <header>
      
    <h1 id="intro-to-kubernetes">Intro to Kubernetes</h1>
    <p>
       Posted on Fri 13 November 2020 in <a href="https://jackmckew.dev/category/software.html">Software</a>

        &#8226; 4 min read
    </p>
  </header>


  <div>
    <body><p>Kubernetes is a portable, extensible, open-source platform for managing containerized workloads and services, that facilitates both declarative configuration and automation. We use Kubernetes as a platform for orchestrating multiple Docker containers for our application, and enables us to scale our application easily.</p>
<p>Kubernetes is managed via a master node, and worker nodes, in combination we call this a cluster. We give instructions to the master node on how we want the cluster to run, and how many workers we need.</p>
<p>This post is apart of a series on Docker/Kubernetes, find the other posts at:</p>
<ul>
<li><a href="https://jackmckew.dev/intro-to-docker.html">Intro to Docker</a></li>
<li><a href="https://jackmckew.dev/develop-and-deploy-with-docker.html">Develop and Develop with Docker</a></li>
<li><a href="https://jackmckew.dev/develop-and-deploy-multi-container-applications.html">Develop and Develop Multi Container Applications</a></li>
<li><a href="https://jackmckew.dev/developing-with-kubernetes.html">Developing with Kubernetes</a></li>
<li><a href="https://jackmckew.dev/deploying-with-kubernetes.html">Deploying with Kubernetes</a></li>
<li><a href="https://jackmckew.dev/deploy-a-node-web-app-to-aws-elastic-beanstalk-with-docker.html">Deploy a Node Web App to AWS Elastic Beanstalk with Docker</a></li>
</ul>
<p><img alt="Kubernetes Logo" class="img-fluid" src="https://jackmckew.dev/img/Kubernetes-logo.png"/></p>
<h2 id="minikube">Minikube</h2>
<p>Minikube is a way of running a development cluster on our local PC. When running in production however, we use managed services offered by different platforms (eg, AWS, GCP, etc). To interact with <code>minikube</code> as it is running though, we use another tool called <code>kubectl</code>.</p>
<h2 id="docker-compose-to-kubernetes">Docker Compose to Kubernetes</h2>
<table class="table-striped table">
<thead>
<tr>
<th>Docker Compose Terminology</th>
<th>Kubernetes Terminology</th>
</tr>
</thead>
<tbody>
<tr>
<td>Each entry could build an image</td>
<td>Kubernetes expects all images to be built</td>
</tr>
<tr>
<td>Each entry represents a container</td>
<td>One config file per object we want to create</td>
</tr>
<tr>
<td>Each entry defines the networking configuration (ports)</td>
<td>We have to set up all networking manually</td>
</tr>
</tbody>
</table>
<h3 id="whats-an-object">What's an Object?</h3>
<p>Notice that we mentioned objects as the equivalent in Kubernetes, but what does this mean? Objects serve different purposes:</p>
<ul>
<li>Running a container</li>
<li>Monitoring a container</li>
<li>Setting up networking</li>
<li>etc</li>
</ul>
<p>Example object types include:</p>
<ul>
<li>StatefulSet</li>
<li>ReplicaController</li>
<li>Pod</li>
<li>Service</li>
</ul>
<blockquote>
<p>There are multiple API versions which gives us access to a different set of object types</p>
</blockquote>
<h4 id="pods">Pods</h4>
<p>Pods let us run containers within nodes. These are one of the most basic objects we can create within Kubernetes. Typically we only put containers that are tightly coupled together within a pod. For example, we might run a database pod which is comprised of 3 containers, the database runtime, a logger and a backup manager. Since if any of these are solely dependant on other containers running, it makes sense to group them together in a pod.</p>
<h4 id="services">Services</h4>
<p>Services let us set up networking within a Kubernetes cluster. There is also 4 sub-types of services:</p>
<ul>
<li>ClusterIP</li>
<li>NodePort</li>
<li>Ingress</li>
<li>LoadBalancer</li>
</ul>
<p>NodePort services allow us to expose a container to the outside network (only for development purposes). We can use selectors and labels to be the equivalent of our service names in docker-compose.</p>
<h4 id="deployment">Deployment</h4>
<p>The deployment object type is better for running groups of identical pods, as the master can manage all the changes &amp; updates for our pods for us (see below for limitations when using pods alone).</p>
<p>Similar to the pod yaml file, the <code>template</code> tag takes the exact same information to create any number of pods (replicas) as specified.</p>
<blockquote>
<p>Ensure to use matchLabels if using labels for the pods, as this will give the master information for updating the cluster.</p>
</blockquote>
<p>We can check all the deployments currently running with <code>kubectl get deployments</code>.</p>
<h2 id="kubectl">Kubectl</h2>
<p>Kubectl is the tool that we use to manage our Kubernetes clusters. If we want to pass a config file into <code>kubectl</code> we use the command <code>kubectl apply -f [filename]</code>. Similar to <code>docker ps</code>, if we want to see all the running pods in our cluster, we can run <code>kubectl get pods</code>. Furthermore, to get all the running services we can run <code>kubectl get services</code>.</p>
<p>Once we have a pod running, we can check to see what containers are running with <code>docker ps</code>. If we kill the container running inside the pod, we will notice that if we run <code>docker ps</code> once again, it'll be live again. Kubernetes will try to restart any containers if anything goes wrong. Kubernetes will try it's best to keep the application in the state that we provide in the configuration.</p>
<h3 id="update-existing-object">Update Existing Object</h3>
<p>If a configuration has been provided a <code>name</code> in the <code>metadata</code>, the running object can be updated by changing the configuration provided the <code>name</code> remains the same.</p>
<p>This updated configuration can then be applied with <code>kubectl apply -f [filename]</code>.</p>
<blockquote>
<p>There is only a specific number of parameters we can change with this (eg for pods: image, activeDeadlineSeconds, etc). Which you will see an error if the variable falls outside the provided.</p>
</blockquote>
<p>For maintaining sets of identical pods, we can bypass the limitations on what fields we can update with the <code>Deployment</code> object kind. Pods are good for one-off development purposes, while Deployments are better for development &amp; production.</p>
<blockquote>
<p>Deployment updates work by attempting to make the changes, and if the above error occurs, it'll automatically kill the pod and restart with the updated configuration.</p>
</blockquote>
<h3 id="get-info-about-an-existing-object">Get Info about an Existing Object</h3>
<p>If we had an object running within a cluster, and we wanted to get information about it, we can run <code>kubectl describe [object_type] [object_name]</code>.</p>
<p>Similarly, we can extract information about all objects of a certain type in the cluster by omitting the <code>object_name</code>. So our command would be <code>kubectl [object_type]</code>.</p>
<h3 id="deleting-existing-objects">Deleting Existing Objects</h3>
<p>Similar to <code>docker stop</code>, we can use <code>kubectl delete -f [config_yaml]</code> to stop and delete an object from the cluster.</p>
<h3 id="update-deployment-images">Update Deployment Images</h3>
<p>A workflow for Kubernetes is we want our application to keep running, and when we push a new image to Docker Hub, we want our Kubernetes cluster to update the objects running on this image, with the updated image.</p>
<blockquote>
<p>This is very challenging, here is a very thorough thread on a conversation discussing ways to do this: <a href="https://github.com/kubernetes/kubernetes/issues/33664">https://github.com/kubernetes/kubernetes/issues/33664</a></p>
</blockquote>
<p>To do this imperatively, we ensure that the image we will be pulling is tagged with versioning on Docker Hub. After this we are able to run the command</p>
<table class="highlighttable table-striped table"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>kubectl <span class="nb">set</span> image <span class="o">[</span>object_type<span class="o">]</span> / <span class="o">[</span>object_name<span class="o">]</span> <span class="o">[</span>container_name<span class="o">]</span> <span class="o">=</span> <span class="o">[</span>new_image_to_use<span class="o">]</span>
</code></pre></div>
</td></tr></tbody></table>
<p>After running this command, the deployment will update the running pods with the new image.</p></body>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://jackmckew.dev/tag/software.html">software</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="https://jackmckew.dev/develop-and-deploy-multi-container-applications.html" title="Develop and Deploy Multi-Container Applications">
      <i class="fa fa-angle-left"></i>  Previous Post
    </a>
    <a class="btn float-right" href="https://jackmckew.dev/developing-with-kubernetes.html" title="Developing with Kubernetes">
       Next Post <i class="fa fa-angle-right"></i>
    </a>
  </div>

  <div class="related-posts">
    <h4> You might enjoy</h4>
    <ul class="related-posts">
      <li><a href="https://jackmckew.dev/episode-12-what-is-git.html">Episode 12 - What is Git?</a></li>
    </ul>
  </div>


<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'jackmckew-dev';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
     Please enable JavaScript to view comments.
</noscript>
<!-- End Disqus -->
</article>

        <footer>
<p>&copy;  </p>
<p> Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme</p>        </footer>
    </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Jack McKew's Blog ",
  "url" : "https://jackmckew.dev",
  "image": "/jm-photo.jpg",
  "description": ""
}
</script>    <script>
        $(document).ready(function() {
            $('#tipue_search_input').tipuesearch();
        });
    </script>
</body>

</html>