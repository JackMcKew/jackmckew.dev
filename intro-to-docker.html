
<!DOCTYPE html>
<html lang="english">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />     <meta name="robots" content="" />     <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">     <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/stylesheet/style.min.css"> 
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/pygments/github.min.css">
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/font-awesome/css/fontawesome.css">
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/font-awesome/css/brands.css">
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/font-awesome/css/solid.css">
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/font-awesome.css">     <script src="https://jackmckew.dev/theme/tipuesearch/jquery.min.js"></script>
    <script src="https://jackmckew.dev/theme/tipuesearch/tipuesearch.min.js"></script>
    <script src="https://jackmckew.dev/theme/tipuesearch/tipuesearch.js"></script>
    <script src="https://jackmckew.dev/theme/tipuesearch/tipuesearch_set.js"></script>
    <link rel="stylesheet" href="https://jackmckew.dev/theme/tipuesearch/tipuesearch.css" />
    <script src="https://jackmckew.dev/tipuesearch_content.js"></script>
    <link href="https://jackmckew.dev/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack McKew's Blog Atom">     <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon"> <!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-131173168-2', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics --><meta name="author" content="Jack McKew" />
<meta name="description" content="What is docker? Docker is a platform for running software that is agnostic to the operating system it runs on. This is extremely useful around solving the &#39;But it works on my machine&#39; problem. This post will go through an intro to docker and how you can use it. A …" />
<meta name="keywords" content="software">


<meta property="og:site_name" content="Jack McKew's Blog"/>
<meta property="og:title" content="Intro to Docker"/>
<meta property="og:description" content="What is docker? Docker is a platform for running software that is agnostic to the operating system it runs on. This is extremely useful around solving the &#39;But it works on my machine&#39; problem. This post will go through an intro to docker and how you can use it. A …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://jackmckew.dev/intro-to-docker.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2020-10-23 00:00:00+11:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://jackmckew.dev/author/jack-mckew.html">
<meta property="article:section" content="Software"/>
<meta property="article:tag" content="software"/>
<meta property="og:image" content="https://jackmckew.dev/img/Moby-logo.png">

    <title>Jack McKew's Blog &ndash; Intro to Docker</title>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client="
     crossorigin="anonymous"></script>
</head>

<body>
    <aside>
        <div>
            <a href="https://jackmckew.dev">
        <img src="/jm-photo.jpg" alt="Jack McKew's Blog" title="Jack McKew's Blog">
      </a>
            <h1><a href="https://jackmckew.dev">Jack McKew's Blog</a></h1>

            <p>Engineer | Software Developer | Data Scientist</p>            <p>Number of Posts: 111</p>
            <p>Number of Words: 82,563</p>
            <p>Number of Lines of Code 5,768</p>
            <form class="navbar-search" action="/search.html" role="search">
                <input type="text" name="q" id="tipue_search_input" placeholder="Search..">
            </form>
            <style>
                .bmc-button img {
                    height: 34px !important;
                    width: 35px !important;
                    margin-bottom: 1px !important;
                    box-shadow: none !important;
                    border: none !important;
                    vertical-align: middle !important;
                }
                
                .bmc-button {
                    margin-top: 15px !important;
                    margin-bottom: 20px !important;
                    padding: 7px 15px 7px 10px !important;
                    line-height: 35px !important;
                    height: 51px !important;
                    text-decoration: none !important;
                    display: inline-flex !important;
                    color: #ffffff !important;
                    /* background-color: #FF813F !important; */
                    border-radius: 5px !important;
                    border: 1px solid transparent !important;
                    padding: 7px 15px 7px 10px !important;
                    font-size: 22px !important;
                    letter-spacing: 0.6px !important;
                    box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;
                    -webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
                    font-family: 'Cookie', cursive !important;
                    -webkit-box-sizing: border-box !important;
                    box-sizing: border-box !important;
                }
                
                .bmc-button:hover,
                .bmc-button:active,
                .bmc-button:focus {
                    -webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
                    text-decoration: none !important;
                    box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
                    opacity: 0.85 !important;
                    color: #ffffff !important;
                }
            </style>
            <link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet">
            <!-- <a class="bmc-button btn" target="_blank" href="https://www.buymeacoffee.com/jackmckew"><img src="https://jackmckew.dev/theme/img/pizza.png" alt="🍕"><span style="margin-left:5px;font-size:28px !important;">Buy me a Pizza</span></a> -->
            <nav>
                <ul class="list">
                    <li><a target="https://jackmckew.github.io/" href="https://jackmckew.github.io/">Portfolio</a></li>
                    <li><a target="https://jackmckew.dev/files/Jack_McKew_Resume.pdf" href="https://jackmckew.dev/files/Jack_McKew_Resume.pdf">Resume</a></li>
                </ul>
            </nav>

            <ul class="social">
                <li>
                    <a  class="sc-twitter" href="https://twitter.com/Jac_McQ" target="_blank">
                        <i class="fab fa-twitter">
            </i>
                    </a>
                </li>
                <li>
                    <a  class="sc-linkedin" href="https://www.linkedin.com/in/jack-mckew/" target="_blank">
                        <i class="fab fa-linkedin">
            </i>
                    </a>
                </li>
                <li>
                    <a  class="sc-github" href="https://github.com/JackMcKew" target="_blank">
                        <i class="fab fa-github">
            </i>
                    </a>
                </li>
            </ul>
        </div>


    </aside>
    <main>
        <nav>
            <a href="https://jackmckew.dev"> Home</a>             <a href="/archives.html">Archives</a>             <a href="/categories.html">Categories</a>             <a href="/tags.html">Tags</a>             <a href="/sitemap.xml">Sitemap</a>             <a href="https://jackmckew.dev/feeds/all.atom.xml"> Atom</a>         </nav>
<article class="single">
  <header>
      
    <h1 id="intro-to-docker">Intro to Docker</h1>
    <p>
       Posted on Fri 23 October 2020 in <a href="https://jackmckew.dev/category/software.html">Software</a>

        &#8226; 6 min read
    </p>
  </header>


  <div>
    <body><p>What is docker? Docker is a platform for running software that is agnostic to the operating system it runs on. This is extremely useful around solving the <em>'But it works on my machine'</em> problem. This post will go through an intro to docker and how you can use it. A crucial part to Docker is the container, <em>a Docker container image is a lightweight, standalone, executable package of software that includes everything needed to run an application: code, runtime, system tools, system libraries and settings</em></p>
<p>I did a post back in 2018 on containerization and mentioned Docker too! <a href="https://jackmckew.dev/episode-6-containerization.html">https://jackmckew.dev/episode-6-containerization.html</a></p>
<p>This post is apart of a series on Docker/Kubernetes, find the other posts at:</p>
<ul>
<li><a href="https://jackmckew.dev/develop-and-deploy-with-docker.html">Develop and Develop with Docker</a></li>
<li><a href="https://jackmckew.dev/develop-and-deploy-multi-container-applications.html">Develop and Develop Multi Container Applications</a></li>
<li><a href="https://jackmckew.dev/intro-to-kubernetes.html">Intro to Kubernetes</a></li>
<li><a href="https://jackmckew.dev/developing-with-kubernetes.html">Developing with Kubernetes</a></li>
<li><a href="https://jackmckew.dev/deploying-with-kubernetes.html">Deploying with Kubernetes</a></li>
<li><a href="https://jackmckew.dev/deploy-a-node-web-app-to-aws-elastic-beanstalk-with-docker.html">Deploy a Node Web App to AWS Elastic Beanstalk with Docker</a></li>
</ul>
<h2 id="docker-ecosystem">Docker Ecosystem</h2>
<p><img alt="Docker Logo" class="img-fluid" src="https://jackmckew.dev/img/Moby-logo.png"/></p>
<p>Docker isn't a single program, it's a suite of programs which we'll refer to as an ecosystem. A brief description of all the components that make the ecosystem is:</p>
<table class="table-striped table">
<thead>
<tr>
<th>Service</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Docker Client</td>
<td>The docker client is how we interact with Docker (eg on the command line)</td>
</tr>
<tr>
<td>Docker Server</td>
<td>The docker server manages running programs inside isolated containers</td>
</tr>
<tr>
<td>Docker Machine</td>
<td>Docker machine lets us install docker engine on virtual hosts (essentially an operating system inside a operation system)</td>
</tr>
<tr>
<td>Docker Images</td>
<td>A docker image is a read-only template of instructions on how to create a docker container</td>
</tr>
<tr>
<td>Docker Hub</td>
<td>Docker hub is a free service provided by Dockeer for finding and sharing container images</td>
</tr>
<tr>
<td>Docker Compose</td>
<td>Docker compose is how we can run multi-container applications.</td>
</tr>
</tbody>
</table>
<h2 id="installing-docker">Installing Docker</h2>
<p>Docker is free to download from <docker.com> along with instructions on installing on your given operating system.</docker.com></p>
<p><a href="https://www.docker.com/products/docker-desktop">https://www.docker.com/products/docker-desktop</a></p>
<h2 id="maintaining-docker-in-the-command-line">Maintaining Docker in the Command Line</h2>
<p>There are many useful commands for interacting with the Docker client.</p>
<table class="table-striped table">
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>docker run [container_id/image]</code></td>
<td>Docker run allows us to both create &amp; start a container from either an ID or an image name. If the docker image isn't found on the local PC, it'll attempt to download from Docker Hub</td>
</tr>
<tr>
<td><code>docker ps</code></td>
<td>This shows all running containers on the current PC</td>
</tr>
<tr>
<td><code>docker ps --all</code></td>
<td>This shows all running &amp; stopped containers on the current PC</td>
</tr>
<tr>
<td><code>docker stop [container_id]</code></td>
<td>This stops a running container, if it doesn't stop after 10 seconds, it will kill the container</td>
</tr>
<tr>
<td><code>docker kill [container_id]</code></td>
<td>This immediately shuts the container without allowing applications to stop inside the container</td>
</tr>
</tbody>
</table>
<h2 id="dockerfile">Dockerfile</h2>
<p>A Dockerfile is a read-only template with instructions for creating a Docker container/image. It's composed with a series of commands, along with their given arguments. A straightforward example of a Dockerfile is:</p>
<table class="table-striped highlighttable table"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1"># Use an existing docker image as a base</span>
<span class="l l-Scalar l-Scalar-Plain">FROM alpine</span>

<span class="l l-Scalar l-Scalar-Plain"># Download and install a dependency</span>
<span class="l l-Scalar l-Scalar-Plain">RUN apk add --update redis</span>

<span class="l l-Scalar l-Scalar-Plain"># Tell the the image what to do when it starts</span>
<span class="l l-Scalar l-Scalar-Plain"># as a container</span>
<span class="l l-Scalar l-Scalar-Plain">CMD ["redis-server"]</span>
</code></pre></div>
</td></tr></tbody></table>
<p>When we create this Docker image with <code>docker build Dockerfile</code>:</p>
<ol>
<li>We use a base starting point of Alpine (a distribution of Linux), if this isn't found on the local PC, it'll download from Docker Hub</li>
<li>We install a program called <code>redis</code> using a pre-installed <code>apk</code> tool</li>
<li>We run <code>redis-server</code> inside the container</li>
</ol>
<h3 id="tagging-images">Tagging Images</h3>
<p>Normally when we run <code>docker build</code> it'll return a container ID, which we'll use to run the container with <code>docker run</code>. Rather than having to copy/paste the container ID each time, we can tag an image with a human-readable name.</p>
<p>To do this we can use the <code>-t</code> option for <code>docker build</code>. An example is:</p>
<p><code>docker build -t [docker_id] / [project_name] : [version]</code></p>
<p>So for me to tag an image I'd run:</p>
<p><code>docker build -t jackmckew/my-new-docker-image:latest Dockerfile</code></p>
<p>Which if we wanted to run this image, we can do this now with <code>docker run jackmckew/my-new-docker-image</code></p>
<blockquote>
<p>The version is optional to provide, if it isn't provided it will default to latest.</p>
</blockquote>
<h3 id="alpine-docker-images">Alpine Docker Images</h3>
<p>Note that we used <code>FROM alpine</code> earlier on in our Dockerfile. <code>alpine</code> is a term used in Docker to represent the most compressed and stripped down version of an image. If we wanted to use a different image like those listed on Docker Hub (<a href="https://hub.docker.com/search?q=&amp;type=image">https://hub.docker.com/search?q=&amp;type=image</a>), we could easily specify to get the <code>alpine</code> version of an image by using <code>FROM node:alpine</code>.  </p>
<blockquote>
<p>Check the description of an image to check whether an alpine version is available.</p>
</blockquote>
<h3 id="change-working-directory">Change Working Directory</h3>
<p>We can change the working directory inside the container with <code>WORKDIR</code>. This is very useful if we don't want to copy things into the root directory of the container. If a folder isn't found in the argument to <code>WORKDIR</code>, it'll be created automatically.</p>
<h2 id="mounting-files">Mounting Files</h2>
<p>Docker defaults to NOT include any files inside an image from the local PC. We always must mount any files we want to use inside the container in the Dockerfile. One way to do this is using the <code>COPY</code> argument in the Dockerfile.</p>
<p>This can be done with: <code>COPY [location_on_local_PC_to_copy] [place_to_story]</code></p>
<p>An example of this is: <code>COPY ./ ./</code>, this will copy the current folder relative to where the terminal is, and places it in the current working directory inside the container.</p>
<h2 id="port-mapping">Port Mapping</h2>
<p>By default no traffic will be routed into a container, meaning a container has it's own set of ports that are not connected to the local PC. Thus we need to set up a mapping between the local PC and the containers ports.</p>
<p>This is not changed within the Dockerfile, but rather when we run the container with the <code>-p</code> flag. This can be done with:</p>
<table class="table-striped highlighttable table"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>docker run -p <span class="o">[</span>local_pc_port<span class="o">]</span> : <span class="o">[</span>container_port<span class="o">]</span> <span class="o">[</span>image_name<span class="o">]</span>
</code></pre></div>
</td></tr></tbody></table>
<blockquote>
<p>By default there is no limitation on default traffic getting out of a container, only limitations on traffic getting in.
This local PC port and the container port do NOT have to match.</p>
</blockquote>
<h2 id="docker-compose">Docker Compose</h2>
<p>Docker compose is a separate tool apart of the Docker CLI, this is used to start up multiple containers at the same time. This helps automate the arguments that would be need to connect multiple containers to talk to each other.</p>
<p>We need to create <code>docker-compose.yml</code> files that we can feed into the docker compose CLI, this is essentially replacing the arguments that we've been typing into the Docker CLI previously.</p>
<p>Here's an example of a <code>docker-compose.yml</code> which will:</p>
<ol>
<li>Create an container that will host a redis server</li>
<li>Create an container that will host a nodejs app</li>
<li>Network the ports of the nodejs app container</li>
</ol>
<table class="table-striped highlighttable table"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">version</span><span class="p">:</span> <span class="s">"3"</span>
<span class="nt">services</span><span class="p">:</span>
  <span class="nt">redis-server</span><span class="p">:</span>
    <span class="nt">image</span><span class="p">:</span> <span class="s">"redis"</span>
  <span class="nt">node-app</span><span class="p">:</span>
    <span class="nt">build</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.</span>
    <span class="nt">ports</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">"8000:8000"</span>
</code></pre></div>
</td></tr></tbody></table>
<p>Let's break it down, first we specify the version of docker-compose to run on. Following that under services, each container that we want to run is indented and then named. Inside the service declaration we can either specify an image to use, or whether to use docker build to build a Dockerfile (note this will look in the current directory for a Dockerfile). Finally mapping port 8000 of the local PC to port 8000 of the docker container.</p>
<p>By using docker-compose, this also automates that the docker containers run on the same network. This would be a major pain to do without using docker-compose.</p>
<p>Once we've created a <code>docker-compose.yml</code>, we can run this by running the command <code>docker-compose up</code> inside the same directory. We can also specify that we want to rebuild all the images inside the <code>docker-compose.yml</code> file with <code>--build</code>, so the new command becomes <code>docker-compose up --build</code>.</p>
<h3 id="stopping-docker-compose">Stopping Docker Compose</h3>
<p>Rather than using <code>docker stop</code> with each of the IDs of the containers that we created. Luckily, we can simply run <code>docker-compose down</code> to stop all the containers after using <code>docker-compose up</code>. This is particularly useful when we run <code>docker-compose up -d</code> which will run the containers in the background, so we can't just CTRL+C out of it.</p>
<h3 id="restart-policies">Restart Policies</h3>
<p>If any container crashes, docker-compose defaults to the restart policy of <code>"no"</code>, which never attempts to restart the container. Potential restart policies in docker-compose are:</p>
<table class="table-striped table">
<thead>
<tr>
<th>Policy</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>"no"</td>
<td>Never restart a container on stop/crash</td>
</tr>
<tr>
<td>always</td>
<td>If a container stops for any reason at all, attempt to restart</td>
</tr>
<tr>
<td>on-failure</td>
<td>Only restart if a container stops with an error</td>
</tr>
<tr>
<td>unless-stopped</td>
<td>Always restart unless forcibly stopped</td>
</tr>
</tbody>
</table>
<p>The restart policy is defined along with other arguments under the service name.</p>
<h3 id="check-docker-compose-status">Check Docker Compose Status</h3>
<p>Similarly to running <code>docker ps</code>, we can run <code>docker-compose ps</code> to check all the running containers that we started with <code>docker-compose up</code>.</p>
<blockquote>
<p>This must be used in the same directory as the <code>docker-compose.yml</code> file.</p>
</blockquote></body>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://jackmckew.dev/tag/software.html">software</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="https://jackmckew.dev/property-based-testing-in-python.html" title="Property Based Testing in Python">
      <i class="fa fa-angle-left"></i>  Previous Post
    </a>
    <a class="btn float-right" href="https://jackmckew.dev/develop-and-deploy-with-docker.html" title="Develop and Deploy with Docker">
       Next Post <i class="fa fa-angle-right"></i>
    </a>
  </div>

  <div class="related-posts">
    <h4> You might enjoy</h4>
    <ul class="related-posts">
      <li><a href="https://jackmckew.dev/episode-12-what-is-git.html">Episode 12 - What is Git?</a></li>
    </ul>
  </div>


<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'jackmckew-dev';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
     Please enable JavaScript to view comments.
</noscript>
<!-- End Disqus -->
</article>

        <footer>
<p>&copy;  </p>
<p> Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme</p>        </footer>
    </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Jack McKew's Blog ",
  "url" : "https://jackmckew.dev",
  "image": "/jm-photo.jpg",
  "description": ""
}
</script>    <script>
        $(document).ready(function() {
            $('#tipue_search_input').tipuesearch();
        });
    </script>
</body>

</html>