
<!DOCTYPE html>
<html lang="english">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />     <meta name="robots" content="" />     <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">     <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/stylesheet/style.min.css"> 
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/pygments/github.min.css">
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/font-awesome/css/fontawesome.css">
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/font-awesome/css/brands.css">
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/font-awesome/css/solid.css">
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/font-awesome.css">     <script src="https://jackmckew.dev/theme/tipuesearch/jquery.min.js"></script>
    <script src="https://jackmckew.dev/theme/tipuesearch/tipuesearch.min.js"></script>
    <script src="https://jackmckew.dev/theme/tipuesearch/tipuesearch.js"></script>
    <script src="https://jackmckew.dev/theme/tipuesearch/tipuesearch_set.js"></script>
    <link rel="stylesheet" href="https://jackmckew.dev/theme/tipuesearch/tipuesearch.css" />
    <script src="https://jackmckew.dev/tipuesearch_content.js"></script>
    <link href="https://jackmckew.dev/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack McKew's Blog Atom">     <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon"> <!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-131173168-2', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics --><meta name="author" content="Jack McKew" />
<meta name="description" content="From a recent post on this blog on how to use GitHub Actions to easily integrate CI/CD into your repository, this post will go into how to create your own GitHub Action! This post was inspired from developing a few GitHub Actions of my own, which I recently released …" />
<meta name="keywords" content="cicd">


<meta property="og:site_name" content="Jack McKew's Blog"/>
<meta property="og:title" content="How to Make GitHub Actions"/>
<meta property="og:description" content="From a recent post on this blog on how to use GitHub Actions to easily integrate CI/CD into your repository, this post will go into how to create your own GitHub Action! This post was inspired from developing a few GitHub Actions of my own, which I recently released …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://jackmckew.dev/how-to-make-github-actions.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2020-06-19 00:00:00+10:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://jackmckew.dev/author/jack-mckew.html">
<meta property="article:section" content="CICD"/>
<meta property="article:tag" content="cicd"/>
<meta property="og:image" content="https://jackmckew.dev/img/pyinstaller-action.png">

    <title>Jack McKew's Blog &ndash; How to Make GitHub Actions</title>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client="
     crossorigin="anonymous"></script>
</head>

<body>
    <aside>
        <div>
            <a href="https://jackmckew.dev">
        <img src="/jm-photo.jpg" alt="Jack McKew's Blog" title="Jack McKew's Blog">
      </a>
            <h1><a href="https://jackmckew.dev">Jack McKew's Blog</a></h1>

            <p>Engineer | Software Developer | Data Scientist</p>            <p>Number of Posts: 111</p>
            <p>Number of Words: 82,564</p>
            <p>Number of Lines of Code 5,768</p>
            <form class="navbar-search" action="/search.html" role="search">
                <input type="text" name="q" id="tipue_search_input" placeholder="Search..">
            </form>
            <style>
                .bmc-button img {
                    height: 34px !important;
                    width: 35px !important;
                    margin-bottom: 1px !important;
                    box-shadow: none !important;
                    border: none !important;
                    vertical-align: middle !important;
                }
                
                .bmc-button {
                    margin-top: 15px !important;
                    margin-bottom: 20px !important;
                    padding: 7px 15px 7px 10px !important;
                    line-height: 35px !important;
                    height: 51px !important;
                    text-decoration: none !important;
                    display: inline-flex !important;
                    color: #ffffff !important;
                    /* background-color: #FF813F !important; */
                    border-radius: 5px !important;
                    border: 1px solid transparent !important;
                    padding: 7px 15px 7px 10px !important;
                    font-size: 22px !important;
                    letter-spacing: 0.6px !important;
                    box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;
                    -webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
                    font-family: 'Cookie', cursive !important;
                    -webkit-box-sizing: border-box !important;
                    box-sizing: border-box !important;
                }
                
                .bmc-button:hover,
                .bmc-button:active,
                .bmc-button:focus {
                    -webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
                    text-decoration: none !important;
                    box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
                    opacity: 0.85 !important;
                    color: #ffffff !important;
                }
            </style>
            <link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet">
            <!-- <a class="bmc-button btn" target="_blank" href="https://www.buymeacoffee.com/jackmckew"><img src="https://jackmckew.dev/theme/img/pizza.png" alt="🍕"><span style="margin-left:5px;font-size:28px !important;">Buy me a Pizza</span></a> -->
            <nav>
                <ul class="list">
                    <li><a target="https://jackmckew.github.io/" href="https://jackmckew.github.io/">Portfolio</a></li>
                    <li><a target="https://jackmckew.dev/files/Jack_McKew_Resume.pdf" href="https://jackmckew.dev/files/Jack_McKew_Resume.pdf">Resume</a></li>
                </ul>
            </nav>

            <ul class="social">
                <li>
                    <a  class="sc-twitter" href="https://twitter.com/Jac_McQ" target="_blank">
                        <i class="fab fa-twitter">
            </i>
                    </a>
                </li>
                <li>
                    <a  class="sc-linkedin" href="https://www.linkedin.com/in/jack-mckew/" target="_blank">
                        <i class="fab fa-linkedin">
            </i>
                    </a>
                </li>
                <li>
                    <a  class="sc-github" href="https://github.com/JackMcKew" target="_blank">
                        <i class="fab fa-github">
            </i>
                    </a>
                </li>
            </ul>
        </div>


    </aside>
    <main>
        <nav>
            <a href="https://jackmckew.dev"> Home</a>             <a href="/archives.html">Archives</a>             <a href="/categories.html">Categories</a>             <a href="/tags.html">Tags</a>             <a href="/sitemap.xml">Sitemap</a>             <a href="https://jackmckew.dev/feeds/all.atom.xml"> Atom</a>         </nav>
<article class="single">
  <header>
      
    <h1 id="how-to-make-github-actions">How to Make GitHub Actions</h1>
    <p>
       Posted on Fri 19 June 2020 in <a href="https://jackmckew.dev/category/cicd.html">CICD</a>

        &#8226; 4 min read
    </p>
  </header>


  <div>
    <body><p>From a recent post on this blog on how to use <a href="https://jackmckew.dev/github-actions-for-cicd.html">GitHub Actions to easily integrate CI/CD into your repository</a>, this post will go into how to create your own GitHub Action!</p>
<p>This post was inspired from developing a few GitHub Actions of my own, which I recently released!</p>
<h2 id="pyinstaller-github-actions">PyInstaller GitHub Actions</h2>
<p>Do you ever want to share your Python code with others, but they don't have Python installed?</p>
<p>You can now easily package your code up as an executable (*.exe) file with GitHub Actions!</p>
<ul>
<li>Windows: <a href="https://github.com/marketplace/actions/pyinstaller-windows">https://github.com/marketplace/actions/pyinstaller-windows</a></li>
<li>Linux: <a href="https://github.com/marketplace/actions/pyinstaller-linux">https://github.com/marketplace/actions/pyinstaller-linux</a></li>
</ul>
<p>Once activated on your repository, each time you push, the action will be kicked off and upload a packaged application to your repository.</p>
<p><img alt="PyInstaller Actions" class="img-fluid" src="https://jackmckew.dev/img/pyinstaller-action.png"/></p>
<h2 id="interrogate-github-action">Interrogate GitHub Action</h2>
<p>Interrogate checks your docstring coverage, integrate it easily into your CI workflow with GitHub Actions.</p>
<p><a href="https://github.com/marketplace/actions/python-interrogate-check">https://github.com/marketplace/actions/python-interrogate-check</a></p>
<h2 id="how-these-actions-were-made">How These Actions were Made</h2>
<p>Currently GitHub actions supports two types of actions out of the box (with subsequent documentation):</p>
<ul>
<li><a href="https://help.github.com/en/actions/creating-actions/creating-a-javascript-action">JavaScript</a></li>
<li><a href="https://help.github.com/en/actions/creating-actions/creating-a-docker-container-action">Docker</a></li>
</ul>
<p>The actions mentioned above are all Docker actions, so this post will focus on how to create Docker GitHub actions. The two tutorials linked above are a great resource for creating GitHub Actions. To summarise the 'creating a docker container action' page linked above, we need a few elements to get a basic docker action working:</p>
<ul>
<li>README</li>
<li>Dockerfile</li>
<li>entrypoint.sh</li>
<li>action.yml</li>
</ul>
<p>Let's take the <a href="#interrogate-github-action">Interrogate Action</a> as the example on how it was made:</p>
<h3 id="readme">README</h3>
<p>This is essentially the 'documentation' behind an action, it should prescribe:</p>
<ul>
<li>What the action does</li>
<li>Why someone should use it</li>
<li>How to integrate it into a CI/CD workflow</li>
<li>Descriptions of any inputs or outputs</li>
</ul>
<h3 id="dockerfile">Dockerfile</h3>
<p>For those that haven't used Docker before, this may be the most daunting part. Essentially a Dockerfile is a set up of steps that should be run when starting the container (aka booting the computer). There's a multitude of available containers developed by the community to handle most of the underlying steps for you. In the case of the interrogate action, we use the container image <code>python:3.8.1-alpine</code>.  What this does, it pulls a copy of the alpine distribution of Linux, pre-configured with Python for us and spins it up. See more variants of Python docker images here <a href="https://hub.docker.com/_/python">https://hub.docker.com/_/python</a>.</p>
<p>Consider a container as a standalone object, when you start it, it won't have any of your files automatically copied into it, so you have to add any files specifically that you may need. Next we copy both the <code>requirements.txt</code> &amp; <code>entrypoint.sh</code> from the repository into our container. Fantastic now we can do something with them. We upgrade pip, install any requirements (eg, interrogate) and then finish up by starting the shell script <code>entrypoint.sh</code>.</p>
<h3 id="actionyml">Action.yml</h3>
<p>The <code>action.yml</code> file contains all the metadata around the action. The syntax is well defined here <a href="https://help.github.com/en/actions/creating-actions/metadata-syntax-for-github-actions">https://help.github.com/en/actions/creating-actions/metadata-syntax-for-github-actions</a>. The things you'll want to include in this file are:</p>
<ul>
<li>The name &amp; description of the action</li>
<li>The branding of the action (eg, the 'logo' looks for the action on the marketplace)<ul>
<li>There's a really good cheat sheet for branding here: <a href="https://github.com/haya14busa/github-action-brandings">https://github.com/haya14busa/github-action-brandings</a></li>
</ul>
</li>
<li>Inputs &amp; Output</li>
<li>How the action runs (on the Dockerfile in this case)</li>
<li>What arguments to pass to the runner (Docker)</li>
</ul>
<p>All the arguments defined here if specified in the <code>args</code> under the <code>runs</code> tag will passed to the next file (<code>entrypoint.sh</code>) upon runtime.</p>
<h3 id="entrypointsh">Entrypoint.sh</h3>
<p>The <code>entrypoint.sh</code> is the equivalent of opening a terminal on the freshly booted PC, and running commands inside it, and thus the formatting is very specific. Ensure to follow the operating system's convention for the docker image that you are using. In this case, it was Linux, so bash is our convention.</p>
<p>First off in the entryooint we need to enable options, this is done in bash using the command <code>set</code>. For most GitHub actions, they should at least enable the option to exit on first error with <code>set -e</code>, as this will make the CI/CD fail under that circumstance. For the interrogate action, we also enable export of all variables, and to trace our commands (prints them to the console), with <code>set -eax</code>. You can find more bash options here: <a href="https://www.tldp.org/LDP/abs/html/options.html">https://www.tldp.org/LDP/abs/html/options.html</a>.</p>
<p>As mentioed before, now it's time to interact with our arguments. These arguments are contained in a numeric variable as listed in <code>action.yml</code> under <code>args</code> (eg, $1, $2, etc). These arguments can then be used in CLI commands and more!</p>
<p>For the interrogate action in particular, the output of the CLI for the package contains a string of 'PASSED' if the coverage is higher than the <code>fail-under</code> argument. In the <code>entrypoint.sh</code> we call the interrogate CLI to check our package and then check the output if it contains 'PASSED' with grep. Grep is one of the most useful utilties as apart of linux, find out more about grep at <a href="https://man7.org/linux/man-pages/man1/grep.1.html">https://man7.org/linux/man-pages/man1/grep.1.html</a>. If the coverage failed, we still run the interrogate CLI to generate a badge if the user wanted to, except exit out of the shell file with <code>exit 1</code> so this fails the action on GitHub; otherwise exit with <code>exit 0</code> to pass!</p>
<h2 id="publish-to-marketplace">Publish to Marketplace</h2>
<p>Once you've implemented these few files, you should get a warning at the top of the repository on GitHub hinting if you want to publish this on the marketplace. This is done smoothly with creating a release of your project, and that's it, done!</p>
<p>Now users can intergrate your action into the CI/CD pipeline as easily as:</p>
<table class="highlighttable table-striped table"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Python Interrogate Check</span>
  <span class="nt">uses</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">JackMcKew/python-interrogate-check@v0.1.1</span>
</code></pre></div>
</td></tr></tbody></table>
<p>Personally, I absolutely love the building block structure of actions so you can piece together all the actions you want to get where you want to go so much easier!</p></body>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://jackmckew.dev/tag/cicd.html">cicd</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="https://jackmckew.dev/geopandas-and-pandas-alive.html" title="Geopandas and Pandas Alive">
      <i class="fa fa-angle-left"></i>  Previous Post
    </a>
    <a class="btn float-right" href="https://jackmckew.dev/how-pandas_alive-was-made.html" title="How Pandas_Alive was Made">
       Next Post <i class="fa fa-angle-right"></i>
    </a>
  </div>

  <div class="related-posts">
    <h4> You might enjoy</h4>
    <ul class="related-posts">
      <li><a href="https://jackmckew.dev/github-actions-for-cicd.html">Github Actions for CI/CD</a></li>
    </ul>
  </div>


<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'jackmckew-dev';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
     Please enable JavaScript to view comments.
</noscript>
<!-- End Disqus -->
</article>

        <footer>
<p>&copy;  </p>
<p> Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme</p>        </footer>
    </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Jack McKew's Blog ",
  "url" : "https://jackmckew.dev",
  "image": "/jm-photo.jpg",
  "description": ""
}
</script>    <script>
        $(document).ready(function() {
            $('#tipue_search_input').tipuesearch();
        });
    </script>
</body>

</html>