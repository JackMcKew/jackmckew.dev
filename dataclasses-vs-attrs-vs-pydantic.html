
<!DOCTYPE html>
<html lang="english">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />     <meta name="robots" content="" />     <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">     <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/stylesheet/style.min.css"> 
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/pygments/github.min.css">
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/font-awesome/css/fontawesome.css">
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/font-awesome/css/brands.css">
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/font-awesome/css/solid.css">
    <link rel="stylesheet" type="text/css" href="https://jackmckew.dev/theme/font-awesome.css">     <script src="https://jackmckew.dev/theme/tipuesearch/jquery.min.js"></script>
    <script src="https://jackmckew.dev/theme/tipuesearch/tipuesearch.min.js"></script>
    <script src="https://jackmckew.dev/theme/tipuesearch/tipuesearch.js"></script>
    <script src="https://jackmckew.dev/theme/tipuesearch/tipuesearch_set.js"></script>
    <link rel="stylesheet" href="https://jackmckew.dev/theme/tipuesearch/tipuesearch.css" />
    <script src="https://jackmckew.dev/tipuesearch_content.js"></script>
    <link href="https://jackmckew.dev/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack McKew's Blog Atom">     <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon"> <!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-131173168-2', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics --><meta name="author" content="Jack McKew" />
<meta name="description" content="Python 3.7 introduced dataclasses, a handy decorator that can make creating classes so much easier and seamless. This post will go into comparing a regular class, a &#39;dataclass&#39; and a class using attrs. Dataclasses were based on attrs, which is a python package that also aims to make creating ‚Ä¶" />
<meta name="keywords" content="datascience, python">


<meta property="og:site_name" content="Jack McKew's Blog"/>
<meta property="og:title" content="Dataclasses vs Attrs vs Pydantic"/>
<meta property="og:description" content="Python 3.7 introduced dataclasses, a handy decorator that can make creating classes so much easier and seamless. This post will go into comparing a regular class, a &#39;dataclass&#39; and a class using attrs. Dataclasses were based on attrs, which is a python package that also aims to make creating ‚Ä¶"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://jackmckew.dev/dataclasses-vs-attrs-vs-pydantic.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2020-08-07 00:00:00+10:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://jackmckew.dev/author/jack-mckew.html">
<meta property="article:section" content="Data Science"/>
<meta property="article:tag" content="datascience"/>
<meta property="article:tag" content="python"/>
<meta property="og:image" content="/jm-photo.jpg">

    <title>Jack McKew's Blog &ndash; Dataclasses vs Attrs vs Pydantic</title>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1052275056735196"
     crossorigin="anonymous"></script>
</head>

<body>
    <aside>
        <div>
            <a href="https://jackmckew.dev">
        <img src="/jm-photo.jpg" alt="Jack McKew's Blog" title="Jack McKew's Blog">
      </a>
            <h1><a href="https://jackmckew.dev">Jack McKew's Blog</a></h1>

            <p>Engineer | Software Developer | Data Scientist</p>            <p>Number of Posts: 100</p>
            <p>Number of Words: 74,224</p>
            <p>Number of Lines of Code 4,557</p>
            <form class="navbar-search" action="/search.html" role="search">
                <input type="text" name="q" id="tipue_search_input" placeholder="Search..">
            </form>
            <style>
                .bmc-button img {
                    height: 34px !important;
                    width: 35px !important;
                    margin-bottom: 1px !important;
                    box-shadow: none !important;
                    border: none !important;
                    vertical-align: middle !important;
                }
                
                .bmc-button {
                    margin-top: 15px !important;
                    margin-bottom: 20px !important;
                    padding: 7px 15px 7px 10px !important;
                    line-height: 35px !important;
                    height: 51px !important;
                    text-decoration: none !important;
                    display: inline-flex !important;
                    color: #ffffff !important;
                    /* background-color: #FF813F !important; */
                    border-radius: 5px !important;
                    border: 1px solid transparent !important;
                    padding: 7px 15px 7px 10px !important;
                    font-size: 22px !important;
                    letter-spacing: 0.6px !important;
                    box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;
                    -webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
                    font-family: 'Cookie', cursive !important;
                    -webkit-box-sizing: border-box !important;
                    box-sizing: border-box !important;
                }
                
                .bmc-button:hover,
                .bmc-button:active,
                .bmc-button:focus {
                    -webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
                    text-decoration: none !important;
                    box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
                    opacity: 0.85 !important;
                    color: #ffffff !important;
                }
            </style>
            <link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet">
            <a class="bmc-button btn" target="_blank" href="https://www.buymeacoffee.com/jackmckew"><img src="https://jackmckew.dev/theme/img/pizza.png" alt="üçï"><span style="margin-left:5px;font-size:28px !important;">Buy me a Pizza</span></a>
            <nav>
                <ul class="list">
                    <li><a target="_blank" href="https://jackmckew.dev/pages/contact.html#contact">Contact</a></li>
                    <li><a target="_blank" href="https://jackmckew.dev/pages/cv-professional.html#cv-professional">CV/Professional</a></li>
                </ul>
            </nav>

            <ul class="social">
                <li>
                    <a  class="sc-twitter" href="https://twitter.com/Jac_McQ" target="_blank">
                        <i class="fab fa-twitter">
            </i>
                    </a>
                </li>
                <li>
                    <a  class="sc-linkedin" href="https://www.linkedin.com/in/jack-mckew/" target="_blank">
                        <i class="fab fa-linkedin">
            </i>
                    </a>
                </li>
                <li>
                    <a  class="sc-github" href="https://github.com/JackMcKew" target="_blank">
                        <i class="fab fa-github">
            </i>
                    </a>
                </li>
            </ul>
        </div>


    </aside>
    <main>
        <nav>
            <a href="https://jackmckew.dev"> Home</a>             <a href="/archives.html">Archives</a>             <a href="/categories.html">Categories</a>             <a href="/tags.html">Tags</a>             <a href="/sitemap.xml">Sitemap</a>             <a href="https://jackmckew.dev/feeds/all.atom.xml"> Atom</a>         </nav>
<article class="single">
  <header>
      
    <h1 id="dataclasses-vs-attrs-vs-pydantic">Dataclasses vs Attrs vs Pydantic</h1>
    <p>
       Posted on Fri 07 August 2020 in <a href="https://jackmckew.dev/category/data-science.html">Data Science</a>

        &#8226; 6 min read
    </p>
  </header>


  <div>
    <body><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Python 3.7 introduced dataclasses, a handy decorator that can make creating classes so much easier and seamless. This post will go into comparing a regular class, a 'dataclass' and a class using attrs. Dataclasses were based on attrs, which is a python package that also aims to make creating classes a much more enjoyable experience. Dataclasses are included in the standard library (provided 3.7+), while to enable attrs, it must be installed with pip (eg, <code>pip install attrs</code>). Mainly they are for automating the (sometimes) painful experience of writing dunder methods. You can read more about dunder methods in a prevous post here: <a href="https://jackmckew.dev/dunders-in-python.html">https://jackmckew.dev/dunders-in-python.html</a></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Dataclasses-vs-Attrs-vs-Pydantic:-Features">Dataclasses vs Attrs vs Pydantic: Features<a class="anchor-link" href="#Dataclasses-vs-Attrs-vs-Pydantic:-Features">¬∂</a></h2><table class="table-striped table">
<thead><tr>
<th>Feature</th>
<th style="text-align:center">Dataclass</th>
<th style="text-align:center">Attrs</th>
<th style="text-align:center">Pydantic</th>
</tr>
</thead>
<tbody>
<tr>
<td>frozen</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
</tr>
<tr>
<td>defaults</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
</tr>
<tr>
<td>totuple</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
</tr>
<tr>
<td>todict</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
</tr>
<tr>
<td>validators</td>
<td style="text-align:center">‚ùå</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
</tr>
<tr>
<td>converters</td>
<td style="text-align:center">‚ùå</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
</tr>
<tr>
<td>slotted</td>
<td style="text-align:center">‚ùå</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚ùå</td>
</tr>
<tr>
<td>programmatic creation</td>
<td style="text-align:center">‚ùå</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚ùå</td>
</tr>
</tbody>
</table>
<h2 id="When-to-use-Dataclasses">When to use Dataclasses<a class="anchor-link" href="#When-to-use-Dataclasses">¬∂</a></h2><p>Dataclasses are mainly about 'grouping' variables together. Choose dataclasses if:</p>
<ul>
<li>The main concern is around the type of the variable, not the value</li>
<li>Adding another package dependancy isn't trivial</li>
</ul>
<h2 id="When-to-use-Attrs">When to use Attrs<a class="anchor-link" href="#When-to-use-Attrs">¬∂</a></h2><p>Attrs are about both grouping &amp; validating. Choose attrs if:</p>
<ul>
<li>You're concerned around the performance (attrs supports slotted class generation which are optimized for CPython)</li>
</ul>
<h2 id="When-to-use-Pydantic">When to use Pydantic<a class="anchor-link" href="#When-to-use-Pydantic">¬∂</a></h2><p>Pydantic is about thorough data validation. Choose <code>pydantic</code> if:</p>
<ul>
<li>You want to validate the values inside each class</li>
<li>You want to santise the input</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-Class">Example Class<a class="anchor-link" href="#Example-Class">¬∂</a></h2><p>First off let's start with our example class in the default way that it would be implemented in Python.</p>
<blockquote><p>We will also use type hints in our class defintions, this is best practice for ensuring our variables are the type we intend them to be. Type hints are also integrated into attrs for creating classes.</p>
</blockquote>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In¬†[1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">typing</span>

<span class="k">class</span> <span class="nc">Data</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">:</span><span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The arguments passed to the <code>__init__</code> constructor are duplicated when instantiating the parameters of the class with the same arguments. This wouldn't typically be the case if the arguments and the parameters don't match. Luckily this is something that both dataclasses and attrs can help with (which we'll see later on).</p>
<p>Now to demonstrate all the different things that both dataclasses &amp; attrs automates for us, let's define a function which takes in the class constructor and prints out all the different elements for each of our classes.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In¬†[2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">class_tester</span><span class="p">(</span><span class="n">class_constructor</span><span class="p">):</span>
    <span class="n">test_class_1</span> <span class="o">=</span> <span class="n">class_constructor</span><span class="p">()</span>
    <span class="n">test_class_2</span> <span class="o">=</span> <span class="n">class_constructor</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Repr/str dunder method representation: </span><span class="si">{</span><span class="n">test_class_1</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Equality dunder method (using ==) (should be True if implemented): </span><span class="si">{</span><span class="n">test_class_1</span> <span class="o">==</span> <span class="n">test_class_2</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Equality dunder method (using is) (should be True if implemented): </span><span class="si">{</span><span class="n">test_class_1</span> <span class="ow">is</span> <span class="n">test_class_2</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">class_tester</span><span class="p">(</span><span class="n">Data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Repr/str dunder method representation: &lt;__main__.Data object at 0x00000269A5758A90&gt;
Equality dunder method (using ==) (should be True if implemented): False
Equality dunder method (using is) (should be True if implemented): False
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Dataclasses">Dataclasses<a class="anchor-link" href="#Dataclasses">¬∂</a></h2><p>Dataclasses by default automatically initialise a bunch of dunder methods for us in a class such as:</p>
<ul>
<li><code>__init__</code> The initialisation method for the class</li>
<li><code>__repr__</code> How the class is represented with print() is called</li>
<li><code>__str__</code> How the class is represented as a string (called with <code>__repr__</code>)</li>
<li><code>__eq__</code> Used when equality operators are used (eg, <code>==</code>)</li>
<li><code>__hash__</code> The hash for the class (called with <code>__eq__</code>)</li>
</ul>
<p>There's also a stack of other dunder methods that can also be automated which are detailed at: <a href="https://docs.python.org/3/library/dataclasses.html">https://docs.python.org/3/library/dataclasses.html</a></p>
<blockquote><p>Thank you to <a href="https://twitter.com/ElevenPhonons">Michael Kosher</a> over on Twitter: <em>It's worth noting validation can be added to dataclasses using a __post_init hook. However, it's pretty low level relative to attrs/#pydantic. I did a similar comparison <a href="https://mpkocher.github.io/2019/05/22/Dataclasses-in-Python-3-7/">https://mpkocher.github.io/2019/05/22/Dataclasses-in-Python-3-7/</a></em></p>
</blockquote>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In¬†[3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Data</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">class_tester</span><span class="p">(</span><span class="n">Data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Repr/str dunder method representation: Data(x=None, y=None, kwargs=None)
Equality dunder method (using ==) (should be True if implemented): True
Equality dunder method (using is) (should be True if implemented): False
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally we have our attrs class, there is two main 'functions' apart of attrs which are <code>attr.s</code> and <code>attr.ib()</code>. <code>attr.s</code> is the decorator to put on a class to have the package initialise the dunder methods for us, while <code>attr.ib()</code> can be used (optional) for defining the parameters of the class. There is lots of optional arguments for both <code>attr.s</code> and <code>attr.ib()</code>, which documented at: <a href="https://www.attrs.org/en/stable/api.html">https://www.attrs.org/en/stable/api.html</a>. Mainly the optional arguments are for enabling/disabling the differing dunder methods in the class.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In¬†[4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">attr</span>

<span class="nd">@attr</span><span class="o">.</span><span class="n">s</span>
<span class="k">class</span> <span class="nc">Data</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">class_tester</span><span class="p">(</span><span class="n">Data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Repr/str dunder method representation: Data(x=None, y=None, kwargs=None)
Equality dunder method (using ==) (should be True if implemented): True
Equality dunder method (using is) (should be True if implemented): False
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Attrs">Attrs<a class="anchor-link" href="#Attrs">¬∂</a></h2><p>Next let's dive into <code>attrs</code></p>
<h3 id="Validators-in-attrs">Validators in attrs<a class="anchor-link" href="#Validators-in-attrs">¬∂</a></h3><p>One major functionality that <code>attrs</code> has but dataclasses doesn't, is validators. This enables us to ensure that when our classes are being created that we validate the inputs to any specific values. Let's build an example that ensure our parameter <code>x</code> is greater than 42, and if not raise an error to the user.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In¬†[5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">attr</span>

<span class="nd">@attr</span><span class="o">.</span><span class="n">s</span>
<span class="k">class</span> <span class="nc">ValidatedData</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">validator</span><span class="o">=</span><span class="n">attr</span><span class="o">.</span><span class="n">validators</span><span class="o">.</span><span class="n">instance_of</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="nd">@x</span><span class="o">.</span><span class="n">validator</span>
    <span class="k">def</span> <span class="nf">more_than_the_meaning_of_life</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">42</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Must be more than the meaning of life!"</span><span class="p">)</span>

<span class="n">test_data_point_1</span> <span class="o">=</span> <span class="n">ValidatedData</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">test_data_point_2</span> <span class="o">=</span> <span class="n">ValidatedData</span><span class="p">(</span><span class="o">-</span><span class="mi">35</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre><span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-5-1f0c941b3dd2&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">     14</span> test_data_point_1 <span class="ansi-yellow-intense-fg ansi-bold">=</span> ValidatedData<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-cyan-intense-fg ansi-bold">42</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     15</span> 
<span class="ansi-green-intense-fg ansi-bold">---&gt; 16</span><span class="ansi-yellow-intense-fg ansi-bold"> </span>test_data_point_2 <span class="ansi-yellow-intense-fg ansi-bold">=</span> ValidatedData<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">-</span><span class="ansi-cyan-intense-fg ansi-bold">35</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">&lt;attrs generated init __main__.ValidatedData&gt;</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, x, y, kwargs)</span>
<span class="ansi-green-fg">      4</span>     self<span class="ansi-yellow-intense-fg ansi-bold">.</span>kwargs <span class="ansi-yellow-intense-fg ansi-bold">=</span> kwargs
<span class="ansi-green-fg">      5</span>     <span class="ansi-green-intense-fg ansi-bold">if</span> _config<span class="ansi-yellow-intense-fg ansi-bold">.</span>_run_validators <span class="ansi-green-intense-fg ansi-bold">is</span> <span class="ansi-green-intense-fg ansi-bold">True</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 6</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>__attr_validator_x<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> __attr_x<span class="ansi-yellow-intense-fg ansi-bold">,</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>x<span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">c:\Users\jackm\Documents\GitHub\jackmckew.dev\drafts\2020\dataclasses-vs-attrs\.env\lib\site-packages\attr\_make.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-intense-fg ansi-bold">(self, inst, attr, value)</span>
<span class="ansi-green-fg">   2144</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> __call__<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> inst<span class="ansi-yellow-intense-fg ansi-bold">,</span> attr<span class="ansi-yellow-intense-fg ansi-bold">,</span> value<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">   2145</span>         <span class="ansi-green-intense-fg ansi-bold">for</span> v <span class="ansi-green-intense-fg ansi-bold">in</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_validators<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 2146</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>v<span class="ansi-yellow-intense-fg ansi-bold">(</span>inst<span class="ansi-yellow-intense-fg ansi-bold">,</span> attr<span class="ansi-yellow-intense-fg ansi-bold">,</span> value<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">   2147</span> 
<span class="ansi-green-fg">   2148</span> 

<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-5-1f0c941b3dd2&gt;</span> in <span class="ansi-cyan-fg">more_than_the_meaning_of_life</span><span class="ansi-blue-intense-fg ansi-bold">(self, attribute, value)</span>
<span class="ansi-green-fg">     10</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> more_than_the_meaning_of_life<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> attribute<span class="ansi-yellow-intense-fg ansi-bold">,</span> value<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     11</span>         <span class="ansi-green-intense-fg ansi-bold">if</span> <span class="ansi-green-intense-fg ansi-bold">not</span> value <span class="ansi-yellow-intense-fg ansi-bold">&gt;=</span> <span class="ansi-cyan-intense-fg ansi-bold">42</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 12</span><span class="ansi-yellow-intense-fg ansi-bold">             </span><span class="ansi-green-intense-fg ansi-bold">raise</span> ValueError<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">"Must be more than the meaning of life!"</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     13</span> 
<span class="ansi-green-fg">     14</span> test_data_point_1 <span class="ansi-yellow-intense-fg ansi-bold">=</span> ValidatedData<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-cyan-intense-fg ansi-bold">42</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-red-intense-fg ansi-bold">ValueError</span>: Must be more than the meaning of life!</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Converters-in-Attrs">Converters in Attrs<a class="anchor-link" href="#Converters-in-Attrs">¬∂</a></h3><p>Converters are used for the sanitisation of the input data when creating classes. If we want to support our users to create our parameters which are intended to be integers, we can santise this input with converters. This let's our classes be much more flexible with our users while still keeping stability in the typing behind the parameters.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In¬†[6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">attr</span>

<span class="nd">@attr</span><span class="o">.</span><span class="n">s</span>
<span class="k">class</span> <span class="nc">ConvertedData</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">converter</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="nd">@x</span><span class="o">.</span><span class="n">validator</span>
    <span class="k">def</span> <span class="nf">more_than_the_meaning_of_life</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">42</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Must be more than the meaning of life!"</span><span class="p">)</span>

<span class="n">test_data_point_1</span> <span class="o">=</span> <span class="n">ConvertedData</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">test_data_point_1</span><span class="p">)</span>

<span class="n">test_data_point_2</span> <span class="o">=</span> <span class="n">ConvertedData</span><span class="p">(</span><span class="s2">"42"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">test_data_point_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>ConvertedData(x=42, y=None, kwargs=None)
ConvertedData(x=42, y=None, kwargs=None)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Programmatic-Creation-of-Attrs">Programmatic Creation of Attrs<a class="anchor-link" href="#Programmatic-Creation-of-Attrs">¬∂</a></h3><p>In some cases you may want to create classes programmatically, well attrs doesn't let us down and provides a method for us! We can easily just pass a dictionary of all the parameters we need.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In¬†[7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">ProgrammaticData</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">make_class</span><span class="p">(</span><span class="s2">"Data"</span><span class="p">,</span>
                            <span class="p">{</span><span class="s1">'x'</span><span class="p">:</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
                            <span class="s1">'y'</span><span class="p">:</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
                            <span class="s1">'kwargs'</span><span class="p">:</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)}</span>
                            <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">Data</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ProgrammaticData</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Data(x=None, y=None, kwargs=None)
Data(x=None, y=None, kwargs=None)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="PyDantic-Dataclasses">PyDantic Dataclasses<a class="anchor-link" href="#PyDantic-Dataclasses">¬∂</a></h2><p><code>Pydantic</code> is a python package for data validation and settings management using python type annotations. Perfect, this is what we were trying to do with dataclasses and attrs. Even more so <code>pydantic</code> provides a dataclass decorator to enable data validation on our dataclasses. This enables us to create extensible classes with data validation even easier than <code>attrs</code>!</p>
<p>The biggest benefit here, is now, by default the type annotations are enforced at runtime and any invalid data raises a nicely formatted error.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In¬†[8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pydantic.dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Data</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">class_tester</span><span class="p">(</span><span class="n">Data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Repr/str dunder method representation: Data(x=None, y=None, kwargs=None)
Equality dunder method (using ==) (should be True if implemented): True
Equality dunder method (using is) (should be True if implemented): False
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pydantic</code> also automatically implements conversion &amp; data validation, let's test this out.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In¬†[9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_data_point</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'123'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test_data_point</span><span class="p">)</span>
<span class="n">Data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'t'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Data(x=123.0, y=None, kwargs=None)
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre><span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">ValidationError</span>                           Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-9-67163ff1f554&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">      1</span> test_data_point <span class="ansi-yellow-intense-fg ansi-bold">=</span> Data<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">'123'</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">      2</span> print<span class="ansi-yellow-intense-fg ansi-bold">(</span>test_data_point<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 3</span><span class="ansi-yellow-intense-fg ansi-bold"> </span>Data<span class="ansi-yellow-intense-fg ansi-bold">(</span>x<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">'t'</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">&lt;string&gt;</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, x, y, kwargs)</span>

<span class="ansi-green-intense-fg ansi-bold">c:\Users\jackm\Documents\GitHub\jackmckew.dev\drafts\2020\dataclasses-vs-attrs\.env\lib\site-packages\pydantic\dataclasses.cp38-win_amd64.pyd</span> in <span class="ansi-cyan-fg">pydantic.dataclasses._process_class._pydantic_post_init</span><span class="ansi-blue-intense-fg ansi-bold">()</span>

<span class="ansi-red-intense-fg ansi-bold">ValidationError</span>: 1 validation error for Data
x
  value is not a valid float (type=type_error.float)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see above, it gives the developers a nicely formatted error message when the data validation failed, and smoothly sanitises the input when it needs to.</p>
</div>
</div>
</div></body>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://jackmckew.dev/tag/datascience.html">datascience</a>
      <a href="https://jackmckew.dev/tag/python.html">python</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="https://jackmckew.dev/generators-in-python.html" title="Generators in Python">
      <i class="fa fa-angle-left"></i>  Previous Post
    </a>
    <a class="btn float-right" href="https://jackmckew.dev/book-review-the-pragmatic-programmer.html" title="Book Review: The Pragmatic Programmer">
       Next Post <i class="fa fa-angle-right"></i>
    </a>
  </div>

  <div class="related-posts">
    <h4> You might enjoy</h4>
    <ul class="related-posts">
      <li><a href="https://jackmckew.dev/looking-for-patterns-in-city-names-interactive-plotting.html">Looking for Patterns in City Names & Interactive Plotting</a></li>
      <li><a href="https://jackmckew.dev/profitable-python-podcast-show-notes.html">Profitable Python Podcast - Show Notes</a></li>
      <li><a href="https://jackmckew.dev/typography-with-matplotlib.html">Typography With Matplotlib</a></li>
      <li><a href="https://jackmckew.dev/define-functions-iteratively-with-python.html">Define Functions Iteratively With Python</a></li>
      <li><a href="https://jackmckew.dev/property-based-testing-in-python.html">Property Based Testing in Python</a></li>
    </ul>
  </div>


<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'jackmckew-dev';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
     Please enable JavaScript to view comments.
</noscript>
<!-- End Disqus -->
</article>

        <footer>
<p>&copy;  </p>
<p> Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme</p>        </footer>
    </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Jack McKew's Blog ",
  "url" : "https://jackmckew.dev",
  "image": "/jm-photo.jpg",
  "description": ""
}
</script>    <script>
        $(document).ready(function() {
            $('#tipue_search_input').tipuesearch();
        });
    </script>
</body>

</html>